package chip8

import (
	"testing"

	"github.com/stretchr/testify/require"
)

func TestOpLdVxI(t *testing.T) {
	c := Chip8{}

	copy(c.r[:], []byte{0x01, 0x02, 0x03, 0x04, 0x05})
	c.i = 0x400

	c.opLdVxI(0)
	require.Equal(t, []byte{0x01, 0x00}, c.m[0x400:0x400+2])
	require.EqualValues(t, 0x401, c.i)

	c.i = 0x400
	c.m[0x405] = 0x0F
	c.opLdVxI(4)
	require.Equal(t, []byte{0x01, 0x02, 0x03, 0x04, 0x05, 0x0F}, c.m[0x400:0x400+6])
	require.EqualValues(t, 0x405, c.i)

	c.i = 0x400
	c.r[15] = 0x0F
	c.opLdVxI(15)
	require.Equal(t, []byte{0x01, 0x02, 0x03, 0x04, 0x05, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F}, c.m[0x400:0x400+16])
	require.EqualValues(t, 0x410, c.i)
}

func TestOpLdIVx(t *testing.T) {
	c := Chip8{}

	copy(c.m[0x0400:], []byte{0x01, 0x02, 0x03, 0x04, 0x05})
	c.i = 0x400

	c.opLdIVx(0)
	require.Equal(t, []byte{0x01, 0x00}, c.r[0:2])
	require.EqualValues(t, 0x401, c.i)

	c.opLdIVx(2)
	require.Equal(t, []byte{0x02, 0x03, 0x04, 0x00}, c.r[0:4])
	require.EqualValues(t, 0x404, c.i)
}
